!function(s){s.fn.message4you=function(e){let c=this,h={line_feed_regex:"\\.|ã€‚",canvas_width:c.width()||s(window).width(),canvas_height:c.height()||s(window).height(),min_delay_character:20,max_delay_character:100,transition_time:1e3,message_limit_time:3e3,wait_at_show:2e3,wait_at_clear:2e3,add_character_handler:(e,a)=>{var t=Math.random()*h.canvas_width*2-h.canvas_width,n=Math.random()*h.canvas_height*2-h.canvas_height,r=15*Math.random(),i=1440*Math.random()-720,c=Math.min(h.min_delay_character,Math.max(h.max_delay_character,h.message_limit_time/a.message_character_length));return e.css({transform:"translate("+t+"px,"+n+"px) rotate("+i+"deg) scale("+r+")",transition:h.transition_time+"ms all",transitionDelay:(a.clear?0:c*a.message_character_index)+"ms",opacity:0}),a.clear||(a.timeout+=c,e.css({lineHeight:1,display:"inline-block",color:"rgb("+(128*Math.random()+64)+","+(128*Math.random()+64)+","+(128*Math.random()+64)+")",fontSize:"min("+100/(a.line_character_length+8)+"vw,"+100/(a.message_length+2)+"vh)",fontWeight:"bold",opacity:0})),e},show_character_handler:(e,a)=>{e.css({transform:"",opacity:1})},clear_character_handler:(e,a)=>{a.clear=!0,h.add_character_handler(e,a)}};s.extend(h,e);let a=function(){let e=function(e){let a=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)");return(e=a.exec(window.location.href))&&e[2]?e[2]:null}("m");var a;return e?(e=decodeURIComponent(atob(decodeURIComponent(e))),h.line_feed_regex&&(a=new RegExp("("+h.line_feed_regex+")([^\n])","g"),e=e.replace(a,"$1\n$2")),e.split("\n\n")):null}();a?async function(){c.css({display:"flex",overflow:"hidden",justifyContent:"center",flexDirection:"column",alignItems:"center"});for(let e=0;e<a.length;e++)c.empty(),await function(a){return promise=new Promise(e=>{let t={timeout:a};c.find(".m4u-char").each((e,a)=>{t.index=e,h.show_character_handler(s(a),t)}),setTimeout(()=>e(),t.timeout)})}(await function(a){return promise=new Promise(e=>{let i={message_length:(a=a.split("\n")).length,message_character_length:0,message_character_index:0,timeout:h.wait_at_show};s.each(a,(e,a)=>{i.message_character_length+=a.length}),s.each(a,(e,t)=>{let n=s("<div>").addClass("m4u-message");i.line_character_length=t.length;for(let a=0;a<t.length;a++){i.line_character_index=a;let e=t.charAt(a);" "===e&&(e="&nbsp;");var r=s("<span>").addClass("m4u-char").html(e);n.append(h.add_character_handler(r,i)),i.message_character_index++}c.append(n)}),setTimeout(()=>e(i.timeout),10)})}(a[e])),e+1!==a.length&&await(promise=new Promise(e=>{let t={timeout:h.wait_at_clear};c.find(".m4u-char").each((e,a)=>{t.index=e,h.clear_character_handler(s(a),t)}),setTimeout(()=>e(),t.timeout)}))}():c.append(s("<form>").attr({method:"GET",target:"preview"}).append(s("<input>").attr({type:"hidden",name:"m"})),s("<textarea>").attr({name:"m"}).css({display:"block",height:"300px",minWidth:"min(500px, 95vw)",padding:"5px"}),s("<button>").text("preview").on("click",()=>{var e=c.find("textarea").val();e&&(c.find("input").val(btoa(encodeURIComponent(e))),c.find("form").submit())}).css({marginTop:"10px",padding:"5px 20px"}))},s(document).ready(()=>{s("#message4you").length&&s("#message4you").message4you()})}(jQuery);